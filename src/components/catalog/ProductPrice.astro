---
import { DiscountMetadata, type Discount } from '../../core/models/discount';

interface Props {
  price: number,
  whsPrice1?: number,
  whsPrice2?: number,
  isDetailed?: boolean
}

const { price, whsPrice1, whsPrice2, isDetailed } = Astro.props;

const priceTitle = DiscountMetadata.length > 0 ? DiscountMetadata[0].title : "Розн. цена";
const whsPriceTitle =  DiscountMetadata.length > 1 ? DiscountMetadata[1].title : "Опт. цена";
const tooltipText = DiscountMetadata.reduce((a: string, cv: { sum: number, title: string }) => a + `'${cv.title}' при заказе от ${cv.sum.toLocaleString()} руб., `, "").slice(0, -2);

const maxWidth = isDetailed ? "max-w-50" : "max-w-34";
const textSize = isDetailed ? "text-base" : "text-sm";
---

<div class="flex flex-row gap-1 align-middle">
  <span>Цена:</span>
  <div class="tooltip text-info" data-tip={tooltipText}>
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block h-6 w-6 stroke-current">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
    </svg>
  </div>
</div>
<div class="stats shadow">
  <div class=`stat place-items-center ${maxWidth}`>
    <div class="stat-title">{priceTitle}</div>
    <div class=`stat-value ${textSize}`>{price} р.</div>              
  </div>
  <div class=`stat place-items-center ${maxWidth}`>
    <div class="stat-title">{whsPriceTitle}</div>
    <div class=`stat-value ${textSize}`>{whsPrice1} р.</div>
  </div>
</div>