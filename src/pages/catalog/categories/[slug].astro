---
export const prerender = false;

import BaseLayout from '../../../layouts/BaseLayout.astro';
import { LiveCollectionNames } from '../../../core/const';
import { type Category } from '../../../core/models/category';
import { $activeCategory, setActiveCategory } from '../../../core/stores/catalog-store';
import { getEntryBySlug } from '../../../core/helpers/live-collection-manager';

const { slug } = Astro.params;
console.log("ðŸš€ ~ Category page ~ slug: %s", slug);

setActiveCategory(undefined);

if (slug) {
  await getEntryBySlug(LiveCollectionNames.Categories, slug)
    .then((result) => {
      if (!result.value) console.log("ðŸš€ ~ Category page ~ category not found by slug:", result.slug);
      if (result.value) setActiveCategory(result.value as Category);
    })
    .catch((reason) => console.error(reason));
}

console.log(
  "ðŸš€ ~ Category page ~ parsed category:", 
  $activeCategory?.value?.title
);
---

<BaseLayout title=`ÐšÐ°Ñ‚Ð°Ð»Ð¾Ð³ - ${slug ?? "None"}`>
  <div class="px-4">
    <span>Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° Ð² Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐµ...</span>
  </div>
</BaseLayout>