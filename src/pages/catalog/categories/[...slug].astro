---
export const prerender = false;

import BaseLayout from '../../../layouts/BaseLayout.astro';
import { getLiveEntry } from 'astro:content';
import { LiveCollectionValidationError } from 'astro/content/runtime';

const { slug } = Astro.params;
console.log("ðŸš€ ~ Categories page ~ slug:", slug)

const { entry: categoryItem, error } = await getLiveEntry('categories', { slug: slug ?? "" });
console.error("ðŸš€ ~ Category page ~ category %o by slug %s", categoryItem, slug)

if (LiveCollectionValidationError.is(error)) {
  console.error("ðŸš€ ~ Category page ~ collection shema validation errors:", error)
} else if (error) {
  console.error("ðŸš€ ~ Category page ~ collection error:", error)
}

//locks/padlocks/eye-locks
//split(slug, '/') -> [locks, padlocks, eyelocks] 
// get categories for Eyelocks with parent Padlocks and ignore Locks

//const sessionProduct = await Astro.session?.get('currentProduct');
const value = categoryItem?.data;
console.log("ðŸš€ ~ Category page ~ data:", value)
//setCurrentProduct(value);
---

<BaseLayout title=`ÐšÐ°Ñ‚Ð°Ð»Ð¾Ð³ - ${slug ?? "TODO: lookup in indexedDb"}`>
  <div class="px-4">
    <span>Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° Ð² Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐµ...</span>
    <span>Ð’Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚: {value?.title ?? "none"}</span>
  </div>
</BaseLayout>