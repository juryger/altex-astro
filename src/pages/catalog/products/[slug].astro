---

import BaseLayout from '../../../layouts/BaseLayout.astro';
import { getLiveEntry } from 'astro:content';
import { LiveCollectionValidationError } from 'astro/content/runtime';
import { type Product } from '../../../loaders/products-loader';
import { currentProduct, assignCurrentProduct } from '../../../stores/product-store';

export const prerender = false;
const { slug } = Astro.params;
console.log("ðŸš€ ~ Product component ~ slug:", slug)

const { entry: product, error } = await getLiveEntry('products', { slug: slug ?? "" });
if (LiveCollectionValidationError.is(error)) {
  console.error("ðŸš€ ~ Product component ~ collection shema validation errors:", error)
} else if (error) {
  console.error("ðŸš€ ~ Product component ~ collection error:", error)
}

var extractedProduct: Product | undefined;
if (product) {
  extractedProduct = product as unknown as Product;
  console.log("ðŸš€ ~ Product component ~ save product to state store:", extractedProduct)
} else {
  console.error("ðŸš€ ~ Product component ~ could not get product by slug:", product)
}
assignCurrentProduct(extractedProduct);
---

<BaseLayout title="ÐšÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ° Ñ‚Ð¾Ð²Ð°Ñ€Ð°">
    <div class="px-4">
      <span>Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° Ð² Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐµ...</span>
    </div>
</BaseLayout>