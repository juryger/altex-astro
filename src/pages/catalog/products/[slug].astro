---
export const prerender = false;

import BaseLayout from '../../../layouts/BaseLayout.astro';
import { getLiveEntry } from 'astro:content';
import { LiveCollectionValidationError } from 'astro/content/runtime';
import { type Product } from '../../../loaders/products-loader';
import { setCurrentProduct } from '../../../stores/product-store';
import { setLatVisitedPage } from '../../../stores/last-visited-page-store';

const { slug } = Astro.params;
console.log("ðŸš€ ~ Product component ~ slug:", slug)

const { entry: productItem, error } = await getLiveEntry('products', { slug: slug ?? "" });
if (LiveCollectionValidationError.is(error)) {
  console.error("ðŸš€ ~ Product component ~ collection shema validation errors:", error)
} else if (error) {
  console.error("ðŸš€ ~ Product component ~ collection error:", error)
}

if (!productItem)
console.error("ðŸš€ ~ Product component ~ could not get product by slug:", productItem)


var extractedProduct: Product | undefined = productItem as unknown as Product;
console.log("ðŸš€ ~ Product component ~ set current product at store:")
setCurrentProduct(extractedProduct);
setLatVisitedPage(slug);
---

<BaseLayout title=`ÐšÐ°Ñ‚Ð°Ð»Ð¾Ð³ - ${extractedProduct?.title}`>
    <div class="px-4">
      <span>Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° Ð² Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐµ...</span>
    </div>
</BaseLayout>